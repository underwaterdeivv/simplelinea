if(void 0===sswMiniRewardJS){var sswMiniRewardApp,sswMiniRewardJS=!0,SswMiniRewardApp=function(e){var s=this;this.isGuest=function(){return void 0===sswApp.customer},this.isOnRewardPage=function(){let e=null,s=null;gwHasShopifyLocale()?(e=sswApp.pageUrls.reward.replace(/^\/[\w\d]+\//,""),s=sswApp.pageUrls.referral.replace(/^\/[\w\d]+\//,"")):(e=sswApp.pageUrls.reward,s=sswApp.pageUrls.referral);let o=new RegExp(e+"$","g"),t=new RegExp(s+"$","g");return null!==location.pathname.match(o)||null!==location.pathname.match(t)},this.isForceLoadTabOnRewardPage=function(){return"undefined"!=typeof sswLoadRewardTabPage&&sswLoadRewardTabPage},this.isForceLoadTabOnOtherPages=function(){return"undefined"!=typeof sswLoadRewardTab&&sswLoadRewardTab},this.isRewardPageUsing=function(){return e('a[href="'+sswApp.pageUrls.reward+'"]').length},this.isRewardTabAvailable=function(){return!(s.isOnRewardPage()&&!s.isForceLoadTabOnRewardPage())||s.isRewardPageUsing()&&!s.isForceLoadTabOnOtherPages()},this.loadTabCaption=function(){Ssw.gwAssetsManifestLoader.requireByKey("reward.tab.caption.css","STYLE");var o={_sid:e.cookie(s.cookieKeys.sessionId),hash_key:e.cookie(s.cookieKeys.hashKey),module:"reward",name:"rewardTabCaption"};e.get(sswProxyUrl+"/lite2/core/widget/index",o,(function(o){e(document.body).append(o),""!=e.trim(o)&&(s.isGuest()||s.loadNotifications(),s.showTabWhenUrlWithHash())}),"html")},this.loadMainJs=function(){return Ssw.gwAssetsManifestLoader.requireByKey("reward.main.js","SCRIPT")},this.loadNotifications=function(){Ssw.gwAssetsManifestLoader.requireByKey("reward.notification.css","STYLE"),Ssw.gwAssetsManifestLoader.requireByKey("reward.notification.js","SCRIPT")},this.loadMainCSS=function(){return Ssw.gwAssetsManifestLoader.requireByKey("reward.main.css","STYLE")},this.loadPopup=function(){return new Promise((function(o,t){var r={_sid:e.cookie(s.cookieKeys.sessionId),hash_key:e.cookie(s.cookieKeys.hashKey)};e.get(sswProxyUrl+"/lite2/reward/index/popup",r,(function(e){o(e)}),"html")}))},this.contentLoadingStatus="waiting",this.loadTabContent=function(o){"waiting"===s.contentLoadingStatus&&(s.contentLoadingStatus="pending",o&&e(".ssw-reward-tab").addClass("ssw-reward-tab-loading"),Promise.all([s.loadMainJs(),s.loadMainCSS(),s.loadPopup()]).then((function(t){e(document.body).append(t[2]),s.contentLoadingStatus="loaded",o&&e(".ssw-reward-tab").removeClass("ssw-reward-tab-loading"),s.toggleTabContent(),s.loadReferLink()})))},this.cookieKeys={sessionId:"hesid",hashKey:"hash_key",rewardBoxShown:"ssw_reward_box_shown",rewardReferral:"ssw_reward_referral",receiverGetReward:"gw_receiver_get_reward"},this.loadReferLink=function(){const s=e(".ssw-reward-program .ssw-reward-box-share-link"),o=e(".ssw-reward-program .ssw-reward-refer-email"),t=s.data("link-generated");void 0!==sswApp.customer&&(t?o.attr("href",`mailto:?body=${s.text().trim()}`):ssw.ajax({url:sswProxyUrl+"/lite2/reward/index/getReferLink",type:"get",dataType:"json",data:{_sid:ssw.cookie("hesid"),hash_key:ssw.cookie("hash_key")},success:function(e){s.html(e.refer_link),o.attr("href",`mailto:?body=${e.refer_link}`)}}))},this.toggleTabContent=function(){e("#ssw-reward-box").fadeToggle(300),e(".ssw-reward-tab-closed").toggleClass("ssw-hide"),e(".ssw-reward-tab-opened").toggleClass("ssw-active"),e(".ssw-reward-tab-opened").hasClass("ssw-active")&&e.cookie(s.cookieKeys.rewardBoxShown,1,{expires:1,path:"/"})},this.showTabWhenUrlWithHash=function(){"#rewards-home"===window.location.hash&&("loaded"===s.contentLoadingStatus?s.toggleTabContent():s.loadTabContent(!0))},this.bindEvents=function(){e(document.body).on("click.ssw-reward-tab",".ssw-reward-tab",(function(e){"loaded"===s.contentLoadingStatus?s.toggleTabContent():s.loadTabContent(!0)})),e(document.body).on("keydown",".ssw-reward-tab",(function(e){"Enter"===e.key&&("loaded"===s.contentLoadingStatus?s.toggleTabContent():s.loadTabContent(!0))})),sswAddEventListener("sswLazyWidgetLoaded",(function(){(ssw(".ssw-reward-page").length||ssw(".ssw-refer-page").length)&&ssw(".ssw-reward-hidden-page").removeClass("ssw-hide")})),s.isGuest()&&(sswAddEventListener("gwReferrerTracked",(function(e){let o=e.detail.refData||{};s.isReferredFromReferralProgram(o)&&(s.setReferralCookies(o),s.isReceiverGetReward()||Promise.all([s.loadNotifications()]).then((function(){s.loadReceiverEmailPopup(o)})))})),e(document.body).on("click",".ssw-referral-notification__button",(function(){e.cookie(s.cookieKeys.receiverGetReward,1,{path:"/",expires:730,secure:"https:"===location.protocol,samesite:"Lax"}),window.location.pathname="/account/register"})),e(document.body).on("submit","#ssw-referral-notification__form",(function(o){o.preventDefault();let t=e(this).serializeArray();return e.post(sswProxyUrl+"/lite2/reward/affiliate/sendRewardToReceiver",t,(function(){e.cookie(s.cookieKeys.receiverGetReward,1,{path:"/",expires:730,secure:"https:"===location.protocol,samesite:Shopify.designMode?"None":"Lax"})})).fail((function(s){const o=e(".ssw-reward-notification__input");if(500===s.status){const e=sswLangs.t("on_error_redeem");o.after('<div class="ssw-referral-notification__form_error">'+e+"</div>")}else o.after('<div class="ssw-referral-notification__form_error">'+s.responseText+"</div>")})).done((function(s){const o=e(".ssw-reward-notification__form-label"),t=sswLangs.t("email_sent_successfully");o.text(t);const r=e("#ssw-referral-notification__form");r.find(".ssw-reward-notification__input, .ssw-referral-notification__form-icon").remove(),r.find(".ssw-reward-notification__form-label").prepend('<i class="ssw-referral-notification__form-icon_success"><svg width="48" height="48" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg"> <rect x="0.75" y="0.75" width="46.5" height="46.5" rx="8.25" fill="white"/> <path d="M34.9092 16L19.9092 31L13.0911 24.1818" stroke="#9B59B6" stroke-width="2.72727" stroke-linecap="round" stroke-linejoin="round"/> <rect x="0.75" y="0.75" width="46.5" height="46.5" rx="8.25" stroke="#9B59B6" stroke-width="1.5"/></svg></i>').addClass("ssw-reward-notification__form-label_success"),r.find(".ssw-referral-notification__form_error").remove(),void 0!==s.discount_code&&s.discount_code&&e.get("/discount/"+s.discount_code)})),!1})))},this.initBoxAppearence=function(o){if(o){var t=function(o){null==o.toElement&&null==o.relatedTarget&&("waiting"!=s.contentLoadingStatus||e.cookie(s.cookieKeys.rewardBoxShown)||s.loadTabContent(!1),window.removeEventListener("blur",t),window.removeEventListener("mouseout",t))};window.addEventListener("blur",t),window.addEventListener("mouseout",t)}},this.isReferredFromReferralProgram=function(e){let s=e.campaign_type||"",o=e.from_user||"";return"affiliate_program"===s&&o},this.setReferralCookies=function(o){e.cookie(s.cookieKeys.rewardReferral,o.from_user,{path:"/",expires:730,secure:"https:"===location.protocol,samesite:Shopify.designMode?"None":"Lax"})},this.isReceiverGetReward=function(){return 1===parseInt(e.cookie(s.cookieKeys.receiverGetReward))},this.loadReceiverEmailPopup=function(s){e.get(sswProxyUrl+"/lite2/reward/affiliate/getReceiverEmailPopup",s,(function(s){e(document.body).append(s),ssw(".ssw-referral-modal").sswModal("show")}),"html")},this.run=function(){s.isRewardTabAvailable()?s.loadTabCaption():s.isGuest()||s.loadNotifications(),s.bindEvents(),s.isOnRewardPage()&&Promise.all([s.loadMainCSS(),s.loadMainJs()]).then((function(s){sswAddEventListener("sswPageLoaded",(function(){e(".ssw-reward-hidden-page-loading").remove(),e(".ssw-reward-hidden-page").removeClass("ssw-hide")}))}))},s.run()};"undefined"!=typeof sswApp&&sswAddEventListener("sswusercheck",(function(){sswMiniRewardApp=new SswMiniRewardApp(ssw)}))}